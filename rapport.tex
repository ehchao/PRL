\documentclass[12pt, french]{report}

\usepackage{amsmath,amsthm,verbatim,amssymb,amsfonts,amscd, graphicx}
\usepackage[utf8]{inputenc}
\usepackage{babel}
\usepackage{enumitem}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{mathrsfs}
\usepackage{graphicx}
\usepackage{yfonts}
\usepackage{amscd}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}
\usepackage{cleveref}
\graphicspath{{images/}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\contentsname}{Table des matières}
%\renewcommand{\refname}{Bibliographie}
\renewcommand{\baselinestretch}{1.05}

\theoremstyle{theoreme}
\newtheorem{theoreme}{Théorème}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\title{PRL}

\author{En-Hung Chao \\ Honghao Li}
\date{\today}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\maketitle

\newpage
\tableofcontents

\newpage
\chapter{Introduction}
\addcontentsline{toc}{section}{Introduction}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Études théoriques des systèmes à plusieurs corps}
\section{Approximation d'Oppenheimer}
Dans la physique des solides, on est ramené à étudier l'équation de Schrödinger d'un système à plusieurs corps ($N$ électrons et $M$ ions par exemple), ce qui consiste à résoudre une équation du type

$$
(\sum_{i=1}^N \frac{\textbf{p}_i^2}{2m_i} + \sum_{I=1}^M \frac{\textbf{P}_i^2}{2M_I}
+ \sum_{i<j}\frac{e^2}{| \textbf{r}_i - \textbf{r}_j |} - \sum_{i, I}\frac{Z_I e^2}{| \textbf{r}_i
- \textbf{R}_I |} + \sum_{I<J}\frac{Z_I Z_J e^2}{| \textbf{R}_i - \textbf{R}_j |} ) \Psi(\textbf{r}, \textbf{R}) = E_{tot} \Psi(\textbf{r}, \textbf{R})
$$
où les lettres en majuscule sont des quantités physiques pour les ions, les lettres en miniscule sont celles pour les électrons et $E_{tot}$ une certaine énergie propre du système qu'on voudra trouver.

Comme le système qu'on considère (les solides) comprend souvent un nombre très élevé d'électrons et d'ions, cette équation devient très difficile à résoudre numériquement. Ainsi, on doit appliquer certaines approximations au système afin de réduire le temps de calcul. La première approximation qu'on peut prendre, celle la plus intuitive, est celle de Born-Oppenheimer. En tenant compte du rapport de masse entre les électrons et les ions et en supposant que les ions sont quasiment figés par rapport aux électrons (ayant une longueur d'onde de De Broglie plus élevée), on peut réécrire l'hamiltonien du système comme

$$
H = \underbrace{\sum_{i=1}^N \frac{\textbf{p}_i^2}{2m_i}}_{T}
+ \underbrace{\sum_{i<j}\frac{e^2}{| \textbf{r}_i - \textbf{r}_j |}}_{V}
- \underbrace{\sum_{i, I}\frac{Z_I e^2}{| \textbf{r}_i - \textbf{R}_I |} + \sum_{I<J}\frac{Z_I Z_J e^2}{| \textbf{R}_i - \textbf{R}_j |}}_{V_{ext}}
$$
où $T$ est l'énergie cinétique des électrons, $V$ leur énergie potentielle d'interaction et $V_{ext}$ l'énergie potentielle dûe à l'extérieur.
Notre problème devient

$$
H \Psi_e(\textbf{r}_1, \ldots \textbf{r}_N) = E_{tot} \Psi_e(\textbf{r}_1, \ldots \textbf{r}_N)
$$

Or, le problème n'est toujours pas simple car la fonction d'onde $\Psi_e$ que l'on cherche est une fonction à plusieurs variables. La méthode proposée par Kohn et Sham~\cite{Koh65} que l'on va présenter dans la suite nous contournent alors le problème.

\subsection{Théorie de la fonctionnelle de la densité (\textit{DFT} en anglais)}
\subsection{La méthode de Kohn et Sham}
\label{subsec-KS}
Si les électrons étaient non-interagissant entre eux, on pourrait écrire l'hamiltonien comme une somme de plusieurs hamiltoniens d'un seul électron, \textit{i.e.},

$$
H = \sum_i H_i^{(1e)} = \sum_i ((-\frac{\hbar^2}{2m}\nabla_i^2 + V_{eff}(\textbf{r}_i))
$$

Le théorème développé par Hohenberg et Kohn~\cite{Hoh64} nous donne la possibilité d'approximer la vraie solution en passant par un système auxiliaire d'électrons non-interagissants.

\begin{theoreme}[Hohnenberg-Kohn]
  La valeur d'espérance d'un observable dans l'état fondamental est l'unique fonctionnelle de la densité d'électron.
\end{theoreme}

La preuve de ce théorème peut être trouvée dans~\cite{Hoh64}.
Ce résultat implique que la valeur d'espérance de l'hamiltonien à l'état fondament total, donc l'énergie fondamentale du système, est une fonctionnel de la densité d'électrons $n(\textbf{r}) = \sum_i \int |\Psi_e(\textbf{r}_1, \ldots \textbf{r}_N) |^2 \delta (\textbf{r} - \textbf{r}_i) \prod_{j=1}^N d\textbf{r}_j$.

Grâce à ce théorème, la résolution d'un système à plusieurs corps devient la recherche d'une fonctionnelle réelle dépendant uniquement d'une variable spatiale. La résolution va être plus simple à implémenter par rapport à la recherche de la fonction d'onde à plusieurs variable $\Psi (\textbf{r}_1, \ldots, \textbf{r}_N)$ du problème initial.

L'article~\cite{Koh65} de Kohn et Sham fournit un autre pillier de la DFT. La méthode de Kohn et Sham consiste à poser un système auxiliaire d'hamiltonien $H' = T' + V'_{tot}$, qui a le même densité d'électrons que notre vrai système $H = T + V + V_{ext}$. Ce système auxiliaire étant non-interagissant, on peut donc prendre pour la densité $n(\textbf{r}) = n'(\textbf{r}) = \sum_i |\phi_i(\textbf{r})|^2$ ,avec la fonction d'onde totale du système s'exprime par $\Psi(\textbf{r}_1 \ldots \textbf{r}_N) = \prod_i \phi_i(\textbf{r})$. On peut donc considérer le système d'équation suivant

$$
(-\frac{1}{2}\nabla_i^2 + V_{tot}[n](\textbf{r}))\phi_i(\textbf{r}) = \epsilon_i \phi_i (\textbf{r})
$$

avec
\begin{equation}\label{Vtot}
V_{tot}(\textbf{r}) = V_{ext}(\textbf{r}) + \int d\textbf{r}' \frac{n(\textbf{r}')}{|\textbf{r} - \textbf{r'}|} + V_{xc}([n], \textbf{r})
\end{equation}

pour chacun des électrons $i$. Le problème devient un problème simple de $N$ équations à une variable (en $\phi_i(\textbf{r})$) séparées. On pourra ensuite faire une résolution auto-consistente en réinjectant $n = \sum_i |\phi_i^{(p)}(\textbf{r})|^2 $ après chaque itération $p$. (L'auto-consistence de cette méthode n'a toujours pas été prouvée.) Une fois minisé l'énergie totale du système auxiliaire $\langle \Psi_e | H' | \Psi_e \rangle $, on obtiendra la densité exacte $n(\textbf{r})$ du vrai système, ce qui nous permettra de trouver l'énergie de l'état fondamental.

Cependant, il y a une approximation à faire pour le terme du potentiel d'échange-corrélation $V_{xc}(\textbf{r}) = \frac{\delta E_{xc}}{\delta n(\textbf{r})}$, où

\begin{equation}
\label{eqn-exc}
  E_{xc} = T[n] + V[n] - \frac{1}{2}\int d\textbf{r}
  \int d\textbf{r}' v(\textbf{r}, \textbf{r}') n(\textbf{r}) n(\textbf{r'}) - T'[n]
\end{equation}

La DFT est aujourd'hui la méthode la plus utilisée pour étudier les propriétés de l'état fondamental d'un système (module d'élasticité, stabilité de la structure, vibrations phononiques, etc)~\cite{Mar04}

%17/02/2017%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Théorie de la fonctionelle de la densité dépendante du temps}\label{sec-TDDFT}
Dans les études de spectroscopie, nous étudions les comportements des matériaux sous exicitation. La constante diélectrique et son inverse sont par exemple des grandeurs physiques que l'on regarde souvent dans les expériences (déduites à partir de l'absorption et de la réflexion des lumières, cf.~\cite{Sot03} Chap. 1). Par conséquent, la simple étude de l'état fondamental ne suffit pas, il nous faut de plus des études sur les états excités.

La méthode que nous allons présenter dans ce rapport, la théorie de la fonctionelle de densité dépendante du temps (\textit{Time-Depending Density Functional Theory}), est utilisée dans le code à l'aide duquel on fait des simulations numériques \textit{ab initio}. 

\subsection{TDDFT}
La TDDFT est une extension de la DFT. Grâce au théorème de Runge et Gross~\cite{Run84}, il est possible d'affirmer que la valeur moyenne de toute observable $\hat{O}$ dépendante du temps est l'unique fonctionelle de la densité d'électrons dépendants du temps. Ceci s'exprime mathématiquement par

$$
\langle \Psi (\textbf{r}_1, \ldots, \textbf{r}_N, t) | \hat{O} | \Psi (\textbf{r}_1, \ldots, \textbf{r}_N, t) \rangle = \hat{O}[n(t)]
$$

Ici, la densité dépendante du temps est la variable fondamentale exactement comme pour le cas statique. La dépendence du temps de la densité provient du fait que le système est soumis à un champ extérieur dépendant du temps. La TDDFT est valable pour n'importe quel type de potentiel extérieur. Ici, nous nous intéressons en particulier aux cas où le potentiel extérieur est "petit", ce qui nous permet de rentrer dans le cadre de la \textbf{réponse linéaire} (cf. Annexe~\ref{TRL}). En fait, comme expliqué dans l'introduction, 

%TODO vérifier si on l'a bien mis dans l'intro

la fonction diélectrique du système $\epsilon^{-1}$ est lié aux propriétés optiques et diélectriques d'un matériau.

Nous allons étudier le comportement du coefficient diélectrique du système en présence d'une excitation extérieure. La relation entre le potentiel d'perturbation extérieure et le potentiel total à l'intérieur du système est donnée par (dans l'espace réciproque de transformation de Fourier temporelle)

\begin{equation}\label{VtotVext}
V_{tot}(\textbf{r}, \omega) = \int d\textbf{r}' \epsilon^{-1}(\omega) V_{ext}(\textbf{r}', \omega)
\end{equation}

On notera $\chi^0$ et $\chi$ les fonctions de réponse linéaire pour $V_{tot}$ et $V_{ext}$ respectivement. On a les relations entre la fonctionelle de densité $n$ et ces deux potentiels

$$
n(\textbf{r}, t) = \int d\textbf{r}' dt' \chi^0(\textbf{r}, \textbf{r'}, t-t') V_{tot}(\textbf{r}', t) = \int d\textbf{r}' dt' \chi(\textbf{r}, \textbf{r'}, t-t') V_{ext}(\textbf{r}', t)
$$

Enfin, la relation entre $\chi^0$ et $\chi$ peut être donnée de façon plus explicite en utilisant la méthode variationnelle

\begin{equation}
  \label{eqn-chi0chi}
  \chi = \frac{\delta n}{\delta V_{ext}}
       = \frac{\delta n}{\delta V_{tot}} \frac{\delta V_{tot}}{\delta n}
       = \chi^0 ( 1 + (v+f_{xc})\chi)
\end{equation}

où nous avons utilisé l'expression de $V_{tot}$ de l'équation~\ref{Vtot}, $v = \frac{\delta V_H}{\delta n}$ pour la variation du deuxième terme dans l'expression de $V_{tot}$ (potentiel de Hatree) et $f_{xc} = \frac{\delta V_{xc}}{\delta n}$. À noter que les convolutions sont remplacées par les multiplications ici pour la raison de simplicité d'écriture.


\subsection{Coefficient diélectrique et fonction de perte}
\label{subsec-eels}
Dans une vraie expérience de spectroscopie, on mesure l'absorption (Abs) et les spectres de perte d'énergie d'électron (\textit{Electron Energy Loss Spectra} en anglais, EELS). Ces deux grandeurs physiques sont données par (~\cite{Sot03}, Sect. 1.5)

$$
Abs = \mathfrak{I}(\epsilon) \quad EELS = -\mathfrak{I}(\epsilon^{-1})
$$

En appliquant la méthode variationnelle sur l'équation~\ref{VtotVext}, on obtient

\begin{equation}\label{epsilon}
  \epsilon^{-1} = 1+ (v + f_{xc})\chi
\end{equation}

L'intérêt principal de notre travail est donc de prédire le comportement de $\epsilon$ du matériau choisi quand des photos de certaines énergies y sont envoyés.

Dans la suite de ce rapport, nous allons présenter les aspects numériques de notre projet, dont les codes qui exploitent les relations que l'on vient d'établir.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\include{chapter3}

\appendix
\chapter{Théorie de la réponse linéaire}\label{TRL}
Soit $n$ un observable. On suppose que $n$ varie en fonction de la perturbation $V$ de par

$$
n(\textbf{r}, t) = \int dt d\textbf{r'}  \chi (\textbf{r}, \textbf{r'}, t-t') V(\textbf{r'}, t')
$$

La fonction $\chi$ s'appelle la \textit{foncition de réponse linéaire}. Dans le cas où le hamiltonien de perturbation dépend aussi de $n$ par la relation suivante

$$
H = \int n(\textbf{r}, t) V(\textbf{r}, t) d\textbf{r}
$$

la fonction de réponse linéaire $\chi$ est donnée par la formule de Kubo\cite{Ton12}

\begin{equation}\label{kubo}
  \chi (\textbf{r}, \textbf{r}', t-t') = -i \langle N | [n(\textbf{r}, t), n(\textbf{r}', t)] |N \rangle \Theta(t-t')
\end{equation}

où $|N \rangle $ désigne l'état dans lequel on mesure l'observable $n$.

Nous supposons que la structure de bande obtenue à partir de l'état fondamental nous fournisse une base complète. Nous partons de $|N \rangle$ l'état fondamental constitué de $N$ électrons dans~\ref{kubo}. Notons $| j_N \rangle $ le j-ième état excité de notre système à $N$ électrons. En faisant la transformation de Fourier temporelle, la fonction de réponse linéaire s'écrit dans ce cas

\begin{equation}
\chi (\textbf{r}, \textbf{r}', \omega) = \sum_j \frac{f_j(\textbf{r}) f_j^*(\textbf{r}') }{\omega - \Omega_j + i \eta} + \frac{f_j(\textbf{r}') f_j^*(\textbf{r}) }{\omega + \Omega_j + i \eta}
\end{equation}

où $f_j = \langle N | n(\textbf{r}, 0) | j_N \rangle$ le nombre d'occupation de l'état $j$, $\Omega_j \pm (E_0 - E_j)$ le \textit{gap} entre l'état $j$ qui et l'état fondamental et enfin $\eta$ le terme de lissage (\textit{broadening}) qui est à tendre vers 0 pour le calcul théorique.

Notons $n$ la fonciton de densité. C'est un observable obtenu à partir de la relation suivante

$$
n = \psi^\dagger \psi
$$

où $\psi$ est l'opérateur d'annihilation et $\psi^\dagger$ l'opérateur de création de l'état que l'on considère (en analogie avec les oscillateurs harmoniques).

On peut développer $\psi$ (et donc $\psi^\dagger$) dans la base des opérateurs de création
pour un seul électron.

$$
\psi = \sum_\textbf{k} \phi_\textbf{k}(\textbf{r}) a_\textbf{k}
$$

où $\phi_\textbf{k}$ est la fonction d'onde de Bloch pour l'impulsion $\textbf{k}$ et $a_\textbf{k}$ l'opérateur de création correspondant. La fonction de réponse linéaire peut encore s'écrire

\begin{equation}\label{chi}
  \chi(\textbf{r}, \textbf{r}', \omega) = \sum_{vc} \frac{(f_v - f_c)\phi_v(\textbf{r}) \phi_c^*(\textbf{r}) \phi_v^*(\textbf{r}') \phi_c(\textbf{r}')}{\omega - (\epsilon_c - \epsilon_v) + i\eta} \quad + \quad \text{a.r.}
\end{equation}

où a.r.\ représente les termes d'anti-résonance et $v$ et $c$ pour bande de valence et bande de conduction respectivement.

\chapter{Paramètres d'entrée}
\section{Paramètres d'entré d'Abinit}
Définition des points $k$ dans l'espace réciproque
\begin{itemize}[leftmargin=0em, font=\bfseries]
  \item[ngkpt] Vecteur de taille 3 qui représente le nombre de points de grille dans les trois directions de translation dans l'espace réciproque.
  \item[nshiftk] Nombre de directions dans lesquelle un décalage de point $k$ sera effectué.
  \item[shiftk] Matrice de nshiftk*3 qui précise les directions et les quantité de décalage.
\end{itemize}
Définition de la maille élémentaire:
\begin{itemize}[leftmargin=0em, font=\bfseries]
  \item[acell] Vecteur de taille 3 élément qui représente l'échelle de la taille de la maille élémentaire.
  \item[rprim] Matrice de 3*3 qui représente les trois directions de translation.
    Ensemble avec acell définit les trois vectors de translation dans l'espace réel.
  \item[ntypat] Nombre de types d'atomes dans la maille élémentaire.
  \item[znucl] Vecteur de taille 3 qui représente le charge nucléaire de chaque type d'atome.
  \item[natom] Nombre d'atomes dans la maille élémentaire.
  \item[typat] Vecteur de taille natom qui précise le type de chaque atome dans la maille élémentaire.
  \item[xred] Matrice de natom*3 qui représente la coordonnée réduite de chaque atome,
    par ordre cohérent avec typat.
\end{itemize}
Paramètres de convergence:
\begin{itemize}[leftmargin=0em, font=\bfseries]
  \item[ecut] Seuil d'énergie qui correspont à l'énergie maximale des ondes planes utilisées dans le calcul à un point k donné.
    Plus grande la ecut, plus précis et moin efficace le calcul.
    Une étude sur la convergence en ecut est alors nécessaire pour avoir à la fois la précision et l'efficacité.
  \item[nstep] Nombre maximal d'itération pour le calcul auto-consistente.
    Ce paramètre assure la cessation du calcul, mais doit être suffisamment grande pour que le calcul converge avant de se terminer.
  \item[tolfe] Seuil de la valeur absolue de la différence d'énergie totale entre deux itérations successives.
    On dit que le calcul converge lorsque l'on passe au-dessous de ce seuil.
\end{itemize}


\section{Paramètres d'entré de DP}
\begin{itemize}[leftmargin=0em, font=\bfseries]
\item[rda, alda] La méthode d'approximation pour le terme du potentiel d'échange-corrélation, \textit{i.e.}, le terme $f_{xc}$ %TODO referer à l'expression de chi0
\item[wfnsh] Le nombre de fonctions dont on a besoin pour faire la transformation de Fourier (wfnsh)%TODO ref to eq
\item[nbands] Le nombre de bandes pour lesquelles les transitions sont autorisées (nbands)
\item[matsh] Le nombre de fonctions dont on a besoin pour faire l'inversion de la matrice afin d'obtenir le coefficient $\chi_0$
\item[lomo] La bande la plus basse à partir de laquelle on autorise les transitions
\item[q] La direction des transitions
\item[omegai] La limite basse de la plage d'énergie considérée
\item[omegae] La limite haute de la plage d'énergie considérée
\item[domega] Le pas de l'échantillonage de la plage d'énergie
\item[broad] Le paramètre de lissage, qui correspond à $\eta$ dans l'expression de $\chi$. Ce paramètre est lié au temps de vie des états considérés. En effet, dans la théorie, on fait tendre ce terme-là vers 0, ce qui signifie que les états que l'on considère peuvent exister en permanant. Or, en pratique, il est très rare d'avoir des états permanants à cause des perturbations. On adjuste donc ce terme par rapport aux résultats expérimentaux. Plus ce terme est grand, plus le spectre va être lisse. L'importance de ce paramètre est surtout de donner des résultats qualitativement corrects.
\item[novkb] Paramètre à mettre si le calcul du terme commutateur est omis. Plus précisément, %TODO
\item[shiftk] Paramètre à mettre dans le cas où aucune symétrie n'est utilisée pour générer la grille des points-k dans le fichier décrivant la fonction de densité de l'état fondamental.
\end{itemize}




\begin{thebibliography}{9}

\bibitem{Sot03}
    F. Sottile, thèse de doctorat (2003)

\bibitem{Hoh64}
    P. Hohenberg et W. Kohn, Phys. Rev. Lett. 136, B864 (1964)

\bibitem{Koh65}
    W. Kohn et L. J. Sham, Phys. Rev. Lett. 140, A1133 (1965)

\bibitem{Ton12}
    D. Tong, Kinetic Theory, cours donné dans University of Cambridge Graduate Course, 2012
    
\bibitem{Mar04}
	R. Martin, Electronic Structure, Cambridge University Press (2012)
	
\bibitem{Run84}
	E. Runge et E.K.U. Gross, Phys. Rev. Lett. 52, 997 (1984)

\end{thebibliography}

\end{document}
